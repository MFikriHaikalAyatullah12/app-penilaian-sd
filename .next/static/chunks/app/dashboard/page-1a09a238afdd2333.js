(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{9022:function(e,a,s){Promise.resolve().then(s.bind(s,1789))},1789:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return m}});var r=s(7437),t=s(2265),l=s(998),n=s(6463),i=s(7138),d=s(6504),o=s(4608),c=s(6760),x=s(8726);function m(){var e,a,s,m,h;let{data:u,status:g}=(0,l.useSession)(),p=(0,n.useRouter)(),[b,v]=(0,t.useState)(null),[j,f]=(0,t.useState)(!0);(0,t.useEffect)(()=>{if("loading"!==g){if(!u){p.push("/login");return}N()}},[u,g,p]);let N=async()=>{try{f(!0);let e=await fetch("/api/students"),a=await e.json(),s=await fetch("/api/grades"),r=await s.json(),t=await fetch("/api/subjects"),l=(await t.json()).map(e=>({id:e.id,name:e.name,gradeCount:r.filter(a=>a.subjectId===e.id).length}));v({totalStudents:a.length,totalGrades:r.length,subjects:l})}catch(e){console.error("Error fetching dashboard data:",e),x.ZP.error("Gagal memuat data dashboard")}finally{f(!1)}},y=async()=>{try{let a=await fetch("/api/export/excel");if(a.ok){var e;let s=await a.blob(),r=window.URL.createObjectURL(s),t=document.createElement("a");t.href=r,t.download="Rekap_Nilai_Kelas_".concat(null==u?void 0:null===(e=u.user)||void 0===e?void 0:e.assignedClass,"_").concat(new Date().toISOString().split("T")[0],".xlsx"),document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(r),document.body.removeChild(t),x.ZP.success("Data berhasil diekspor ke Excel!")}else x.ZP.error("Gagal mengekspor data")}catch(e){console.error("Export error:",e),x.ZP.error("Terjadi kesalahan saat mengekspor data")}},w=async()=>{if(window.confirm("Apakah Anda yakin ingin menghapus akun? Semua data siswa dan nilai akan ikut terhapus. Tindakan ini tidak dapat dibatalkan."))try{let e=await fetch("/api/user/delete",{method:"DELETE"});if(e.ok)x.ZP.success("Akun berhasil dihapus"),p.push("/login");else{let a=await e.json();x.ZP.error(a.error||"Gagal menghapus akun")}}catch(e){console.error("Delete account error:",e),x.ZP.error("Terjadi kesalahan saat menghapus akun")}};return"loading"===g||j?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(d.Z,{}),(0,r.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"Memuat data..."})]})})]}):u?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(d.Z,{}),(0,r.jsx)("div",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"px-4 py-6 sm:px-0",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Dashboard Kelas ",null===(e=u.user)||void 0===e?void 0:e.assignedClass]}),(0,r.jsxs)("p",{className:"mt-2 text-gray-600",children:["Selamat datang, ",null===(a=u.user)||void 0===a?void 0:a.name,"! Kelola data siswa dan nilai di dashboard ini."]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,r.jsx)(o.Z,{children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-blue-600",children:(null==b?void 0:b.totalStudents)||0}),(0,r.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"Total Siswa"})]})}),(0,r.jsx)(o.Z,{children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-green-600",children:(null==b?void 0:b.totalGrades)||0}),(0,r.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"Total Nilai"})]})}),(0,r.jsx)(o.Z,{children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-purple-600",children:(null==b?void 0:null===(s=b.subjects)||void 0===s?void 0:s.length)||0}),(0,r.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"Mata Pelajaran"})]})})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(o.O,{title:"Aksi Cepat"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,r.jsx)(i.default,{href:"/students",className:"block",children:(0,r.jsx)("div",{className:"group p-6 bg-gradient-to-br from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200 rounded-lg border border-blue-200 transition-all duration-200 hover:shadow-md cursor-pointer",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-3 bg-blue-500 rounded-lg group-hover:bg-blue-600 transition-colors",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 group-hover:text-blue-700",children:"Kelola Data Siswa"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Tambah, edit, hapus data siswa"})]})]})})}),(0,r.jsx)(i.default,{href:"/grades",className:"block",children:(0,r.jsx)("div",{className:"group p-6 bg-gradient-to-br from-green-50 to-green-100 hover:from-green-100 hover:to-green-200 rounded-lg border border-green-200 transition-all duration-200 hover:shadow-md cursor-pointer",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-3 bg-green-500 rounded-lg group-hover:bg-green-600 transition-colors",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 group-hover:text-green-700",children:"Input & Kelola Nilai"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Input nilai dan kelola penilaian"})]})]})})}),(0,r.jsx)("div",{onClick:y,className:"group p-6 bg-gradient-to-br from-purple-50 to-purple-100 hover:from-purple-100 hover:to-purple-200 rounded-lg border border-purple-200 transition-all duration-200 hover:shadow-md cursor-pointer",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"p-3 bg-purple-500 rounded-lg group-hover:bg-purple-600 transition-colors",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 group-hover:text-purple-700",children:"Export ke Excel"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Download data dalam format Excel"})]})]})})]})]})}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(o.O,{title:"Ringkasan Mata Pelajaran"}),(0,r.jsxs)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[null==b?void 0:null===(m=b.subjects)||void 0===m?void 0:m.map(e=>(0,r.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,r.jsx)("span",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:[e.gradeCount," nilai"]})]},e.id)),!(null==b?void 0:null===(h=b.subjects)||void 0===h?void 0:h.length)&&(0,r.jsx)("p",{className:"text-gray-500 text-sm text-center py-4",children:"Belum ada data nilai"})]})]})}),(0,r.jsxs)(o.Z,{children:[(0,r.jsx)(o.O,{title:"Zona Berbahaya"}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:"Hapus Akun"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"Menghapus akun akan menghapus semua data siswa dan nilai. Tindakan ini tidak dapat dibatalkan."})]}),(0,r.jsx)(c.z,{variant:"danger",onClick:w,children:"Hapus Akun"})]})})]})]})})]}):null}},6504:function(e,a,s){"use strict";s.d(a,{Z:function(){return o}});var r=s(7437),t=s(998),l=s(7138),n=s(6463),i=s(6760);let d=[{name:"Dashboard",href:"/dashboard"},{name:"Data Siswa",href:"/students"},{name:"Input Nilai",href:"/grades"}];function o(){var e,a,s,o;let{data:c}=(0,t.useSession)(),x=(0,n.usePathname)(),m=()=>{(0,t.signOut)({callbackUrl:"/login"})};return c?(0,r.jsx)("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(l.default,{href:"/dashboard",className:"flex items-center",children:(0,r.jsx)("h1",{className:"text-xl font-bold text-blue-600",children:"Penilaian SD"})}),(0,r.jsx)("div",{className:"hidden sm:ml-8 sm:flex sm:space-x-8",children:d.map(e=>(0,r.jsx)(l.default,{href:e.href,className:"inline-flex items-center px-1 pt-1 text-sm font-medium border-b-2 transition-colors ".concat(x===e.href?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.name},e.name))})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"hidden sm:flex sm:items-center sm:space-x-4",children:[(0,r.jsxs)("span",{className:"text-sm text-gray-700",children:[null===(e=c.user)||void 0===e?void 0:e.name," - Kelas ",null===(a=c.user)||void 0===a?void 0:a.assignedClass]}),(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:m,children:"Logout"})]}),(0,r.jsx)("div",{className:"sm:hidden",children:(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:m,children:"Logout"})})]})]}),(0,r.jsxs)("div",{className:"sm:hidden pb-3 pt-2 space-y-1",children:[d.map(e=>(0,r.jsx)(l.default,{href:e.href,className:"block pl-3 pr-4 py-2 text-base font-medium transition-colors ".concat(x===e.href?"bg-blue-50 border-l-4 border-blue-500 text-blue-700":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"),children:e.name},e.name)),(0,r.jsxs)("div",{className:"pl-3 pr-4 py-2 text-sm text-gray-600",children:[null===(s=c.user)||void 0===s?void 0:s.name," - Kelas ",null===(o=c.user)||void 0===o?void 0:o.assignedClass]})]})]})}):null}},6760:function(e,a,s){"use strict";s.d(a,{z:function(){return t}});var r=s(7437);s(2265);let t=e=>{let{variant:a="primary",size:s="md",loading:t=!1,disabled:l,children:n,className:i="",...d}=e;return(0,r.jsxs)("button",{className:"".concat("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-gray-300 bg-white hover:bg-gray-50 focus:ring-blue-500"}[a]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[s]," ").concat(i),style:{color:"outline"===a?"#374151":"#ffffff",backgroundColor:"primary"===a?"#2563eb":"secondary"===a?"#4b5563":"danger"===a?"#dc2626":"#ffffff"},disabled:l||t,...d,children:[t&&(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]})}},4608:function(e,a,s){"use strict";s.d(a,{O:function(){return l},Z:function(){return t}});var r=s(7437);s(2265);let t=e=>{let{children:a,className:s="",padding:t=!0}=e;return(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 ".concat(t?"p-6":""," ").concat(s),children:a})},l=e=>{let{title:a,subtitle:s,action:t}=e;return(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:a}),s&&(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:s})]}),t&&(0,r.jsx)("div",{children:t})]})}}},function(e){e.O(0,[726,998,291,971,23,744],function(){return e(e.s=9022)}),_N_E=e.O()}]);
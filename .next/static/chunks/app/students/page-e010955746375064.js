(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{1484:function(e,s,a){Promise.resolve().then(a.bind(a,125))},125:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return u}});var t=a(7437),n=a(2265),r=a(998),i=a(6463),l=a(6504),o=a(4608),c=a(6760),d=a(5260),m=a(8726);function u(){var e;let{data:s,status:a}=(0,r.useSession)(),u=(0,i.useRouter)(),[x,h]=(0,n.useState)([]),[f,p]=(0,n.useState)(!0),[b,g]=(0,n.useState)(!1),[y,j]=(0,n.useState)(null),[N,w]=(0,n.useState)(!1),[v,k]=(0,n.useState)({name:"",nisn:""}),[S,C]=(0,n.useState)({});(0,n.useEffect)(()=>{if("loading"!==a){if(!s){u.push("/login");return}z()}},[s,a,u]);let z=async()=>{try{p(!0);let e=await fetch("/api/students");if(e.ok){let s=await e.json();h(s)}else m.ZP.error("Gagal memuat data siswa")}catch(e){console.error("Error fetching students:",e),m.ZP.error("Terjadi kesalahan saat memuat data")}finally{p(!1)}},P=()=>{let e={};return v.name.trim()?v.name.trim().length<2&&(e.name="Nama minimal 2 karakter"):e.name="Nama siswa harus diisi",v.nisn&&v.nisn.trim()&&(/^[\d.]+$/.test(v.nisn.trim())?v.nisn.trim().length<3&&(e.nisn="NISN minimal 3 karakter"):e.nisn="NISN hanya boleh berisi angka dan titik"),C(e),0===Object.keys(e).length},Z=e=>{let{name:s,value:a}=e.target;k(e=>({...e,[s]:a})),S[s]&&C(e=>({...e,[s]:void 0}))},T=e=>{e?(j(e),k({name:e.name,nisn:e.nisn||""})):(j(null),k({name:"",nisn:""})),C({}),g(!0)},E=()=>{g(!1),j(null),k({name:"",nisn:""}),C({})},I=async e=>{if(e.preventDefault(),console.log("Student form submitted with data:",v),!P()){m.ZP.error("Mohon perbaiki kesalahan pada form");return}w(!0);try{let e=y?"/api/students/".concat(y.id):"/api/students",s=await fetch(e,{method:y?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:v.name.trim(),nisn:v.nisn.trim()||null})}),a=await s.json();console.log("Student API response:",a),s.ok?(m.ZP.success(y?"Siswa berhasil diupdate!":"Siswa berhasil ditambahkan!"),z(),E()):m.ZP.error(a.error||"Terjadi kesalahan")}catch(e){console.error("Error saving student:",e),m.ZP.error("Terjadi kesalahan saat menyimpan data")}finally{w(!1)}},O=async e=>{if(window.confirm('Apakah Anda yakin ingin menghapus siswa "'.concat(e.name,'"? Semua nilai siswa ini akan ikut terhapus.')))try{let s=await fetch("/api/students/".concat(e.id),{method:"DELETE"});if(s.ok)m.ZP.success("Siswa berhasil dihapus!"),z();else{let e=await s.json();m.ZP.error(e.error||"Gagal menghapus siswa")}}catch(e){console.error("Error deleting student:",e),m.ZP.error("Terjadi kesalahan saat menghapus siswa")}};return"loading"===a?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(l.Z,{}),(0,t.jsx)("div",{className:"container mx-auto px-6 py-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4",style:{color:"#6b7280"},children:"Memuat data..."})]})})]}):s?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(l.Z,{}),(0,t.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold",style:{color:"#111827"},children:["Data Siswa Kelas ",null===(e=s.user)||void 0===e?void 0:e.assignedClass]}),(0,t.jsxs)("p",{style:{color:"#6b7280"},children:["Total: ",x.length," siswa"]})]}),(0,t.jsx)(c.z,{onClick:()=>T(),children:"Tambah Siswa"})]}),f?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4",style:{color:"#6b7280"},children:"Memuat data siswa..."})]}):(0,t.jsx)(o.Z,{children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"#374151"},children:"NO"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"#374151"},children:"NAMA SISWA"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider",style:{color:"#374151"},children:"NISN"}),(0,t.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider",style:{color:"#374151"},children:"AKSI"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===x.length?(0,t.jsx)("tr",{children:(0,t.jsxs)("td",{colSpan:4,className:"px-6 py-8 text-center",children:[(0,t.jsx)("p",{style:{color:"#6b7280"},children:"Belum ada siswa yang terdaftar"}),(0,t.jsx)(c.z,{onClick:()=>T(),className:"mt-4",variant:"outline",children:"Tambah Siswa Pertama"})]})}):x.map((e,s)=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",style:{color:"#374151"},children:s+1}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("div",{className:"text-sm font-medium",style:{color:"#111827"},children:e.name})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",style:{color:"#6b7280"},children:e.nisn||"-"}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,t.jsxs)("div",{className:"space-x-2",children:[(0,t.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>T(e),children:"Edit"}),(0,t.jsx)(c.z,{variant:"danger",size:"sm",onClick:()=>O(e),children:"Hapus"})]})})]},e.id))})]})})})]}),(0,t.jsx)(d.u,{isOpen:b,onClose:E,title:y?"Edit Siswa":"Tambah Siswa Baru",children:(0,t.jsxs)("form",{onSubmit:I,className:"space-y-6",children:[(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:"#374151"},children:"Nama Siswa"}),(0,t.jsx)("input",{type:"text",name:"name",value:v.name,onChange:Z,placeholder:"Masukkan nama siswa",className:"\n                w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n                ".concat(S.name?"border-red-500":"border-gray-300","\n                text-gray-900 placeholder-gray-500 bg-white\n              "),style:{color:"#111827",backgroundColor:"#ffffff"}}),S.name&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",style:{color:"#dc2626"},children:S.name})]}),(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("label",{className:"block text-sm font-medium mb-2",style:{color:"#374151"},children:"NISN (Opsional)"}),(0,t.jsx)("input",{type:"text",name:"nisn",value:v.nisn,onChange:Z,placeholder:"Nomor Induk Siswa Nasional (boleh dikosongkan)",className:"\n                w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\n                ".concat(S.nisn?"border-red-500":"border-gray-300","\n                text-gray-900 placeholder-gray-500 bg-white\n              "),style:{color:"#111827",backgroundColor:"#ffffff"}}),S.nisn&&(0,t.jsx)("p",{className:"mt-1 text-sm text-red-600",style:{color:"#dc2626"},children:S.nisn}),(0,t.jsx)("p",{className:"mt-1 text-xs",style:{color:"#6b7280"},children:"Nomor Induk Siswa Nasional (boleh dikosongkan)"})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,t.jsx)(c.z,{type:"button",variant:"outline",onClick:E,children:"Batal"}),(0,t.jsx)(c.z,{type:"submit",disabled:N,children:N?"Menyimpan...":y?"Update":"Tambah"})]})]})})]}):null}},6504:function(e,s,a){"use strict";a.d(s,{Z:function(){return c}});var t=a(7437),n=a(998),r=a(7138),i=a(6463),l=a(6760);let o=[{name:"Dashboard",href:"/dashboard"},{name:"Data Siswa",href:"/students"},{name:"Input Nilai",href:"/grades"}];function c(){var e,s,a,c;let{data:d}=(0,n.useSession)(),m=(0,i.usePathname)(),u=()=>{(0,n.signOut)({callbackUrl:"/login"})};return d?(0,t.jsx)("nav",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,t.jsxs)("div",{className:"flex justify-between h-16",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(r.default,{href:"/dashboard",className:"flex items-center",children:(0,t.jsx)("h1",{className:"text-xl font-bold text-blue-600",children:"Penilaian SD"})}),(0,t.jsx)("div",{className:"hidden sm:ml-8 sm:flex sm:space-x-8",children:o.map(e=>(0,t.jsx)(r.default,{href:e.href,className:"inline-flex items-center px-1 pt-1 text-sm font-medium border-b-2 transition-colors ".concat(m===e.href?"border-blue-500 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:e.name},e.name))})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"hidden sm:flex sm:items-center sm:space-x-4",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-700",children:[null===(e=d.user)||void 0===e?void 0:e.name," - Kelas ",null===(s=d.user)||void 0===s?void 0:s.assignedClass]}),(0,t.jsx)(l.z,{variant:"outline",size:"sm",onClick:u,children:"Logout"})]}),(0,t.jsx)("div",{className:"sm:hidden",children:(0,t.jsx)(l.z,{variant:"outline",size:"sm",onClick:u,children:"Logout"})})]})]}),(0,t.jsxs)("div",{className:"sm:hidden pb-3 pt-2 space-y-1",children:[o.map(e=>(0,t.jsx)(r.default,{href:e.href,className:"block pl-3 pr-4 py-2 text-base font-medium transition-colors ".concat(m===e.href?"bg-blue-50 border-l-4 border-blue-500 text-blue-700":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"),children:e.name},e.name)),(0,t.jsxs)("div",{className:"pl-3 pr-4 py-2 text-sm text-gray-600",children:[null===(a=d.user)||void 0===a?void 0:a.name," - Kelas ",null===(c=d.user)||void 0===c?void 0:c.assignedClass]})]})]})}):null}},6760:function(e,s,a){"use strict";a.d(s,{z:function(){return n}});var t=a(7437);a(2265);let n=e=>{let{variant:s="primary",size:a="md",loading:n=!1,disabled:r,children:i,className:l="",...o}=e;return(0,t.jsxs)("button",{className:"".concat("inline-flex items-center justify-center font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500",outline:"border border-gray-300 bg-white hover:bg-gray-50 focus:ring-blue-500"}[s]," ").concat({sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[a]," ").concat(l),style:{color:"outline"===s?"#374151":"#ffffff",backgroundColor:"primary"===s?"#2563eb":"secondary"===s?"#4b5563":"danger"===s?"#dc2626":"#ffffff"},disabled:r||n,...o,children:[n&&(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i]})}},4608:function(e,s,a){"use strict";a.d(s,{O:function(){return r},Z:function(){return n}});var t=a(7437);a(2265);let n=e=>{let{children:s,className:a="",padding:n=!0}=e;return(0,t.jsx)("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 ".concat(n?"p-6":""," ").concat(a),children:s})},r=e=>{let{title:s,subtitle:a,action:n}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:s}),a&&(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:a})]}),n&&(0,t.jsx)("div",{children:n})]})}},5260:function(e,s,a){"use strict";a.d(s,{u:function(){return n}});var t=a(7437);a(2265);let n=e=>{let{isOpen:s,onClose:a,title:n,children:r,size:i="md"}=e;return s?(0,t.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,t.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),(0,t.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-full ".concat({sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[i]," max-h-[90vh] overflow-y-auto"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:n}),(0,t.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)("div",{className:"p-6",children:r})]})]})}):null}}},function(e){e.O(0,[726,998,291,971,23,744],function(){return e(e.s=1484)}),_N_E=e.O()}]);